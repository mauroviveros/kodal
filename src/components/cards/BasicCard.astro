---
import { Avatar, Button, Card } from '@components/ui';
import type { Pet } from '@types';
import { getTimeSince } from '@utils';

interface Props {
  pet: Pet;
}

const { pet } = Astro.props;
const phone_message = `Hola, he encontrado a tu mascota ${pet.name}. Por favor, contÃ¡ctame.`;
const info = [
  { label: 'Raza', value: pet.breed, display: pet.breed || 'Desconocida' },
  { label: 'Edad', value: pet.birthdate, display: pet.birthdate && getTimeSince(pet.birthdate) },
  { label: 'Peso', value: pet.weight, display: `${pet.weight} kg` },
].filter(({ value }) => value);
---

<Card>
  <header slot="header">
    <Avatar alt={pet.name} class="mx-auto mb-6 size-32" />
    <h1 class="mb-2 text-3xl font-bold text-balance break-all">{pet.name}</h1>
    <a
      href={`https://wa.me/${pet.owner_phone}?text=${encodeURIComponent(phone_message)}`}
      target="_blank"
      rel="noopener noreferrer"
    >
      <Button>Enviar Whatsapp</Button>
    </a>
  </header>

  {
    pet.message && (
      <blockquote class="bg-primary/5 border-primary/20 rounded-lg border p-4">
        <p class="text-on-muted text-center text-sm">{pet.message}</p>
      </blockquote>
    )
  }
  <div
    class:list={[
      'grid grid-cols-1 gap-4',
      info.length === 2 && 'md:grid-cols-2',
      info.length > 2 && 'md:grid-cols-3',
    ]}
  >
    {
      info.map(({ label, display }) => (
        <div class="bg-muted/50 flex flex-col items-center justify-center rounded-lg p-4 text-center">
          <p class="text-primary text-2xl font-bold text-balance break-all">{display}</p>
          <p class="text-on-muted text-sm">{label}</p>
        </div>
      ))
    }
  </div>
</Card>
