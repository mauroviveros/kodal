---
import type { Slot } from '@types';
import { Icon } from 'astro-icon/components';
interface Props {
  medalSlot: Slot;
  QRbase64: string;
}
const dialog_id = `dialog-view-${Astro.props.medalSlot.id}`;
---

<button id={`${dialog_id}-btn`} type="button" class="btn btn-sm">
  <Icon name="lucide:eye" class="size-4" />
</button>

<dialog id={dialog_id} closedby="any">
  <header class="dialog-header">
    <h2 class="dialog-title">Código QR</h2>
  </header>

  <section class="dialog-content">
    <figure
      class="relative mx-auto flex w-48 flex-col items-center justify-center gap-2 text-center"
    >
      <div class="border-primary rounded-lg border-4 bg-white">
        <img
          src={Astro.props.QRbase64}
          alt={`Código QR - ${Astro.props.medalSlot.id}`}
          loading="lazy"
          decoding="async"
        />
      </div>

      <figcaption class="w-full truncate text-sm font-medium">
        <a
          href={new URL(`/medal/${Astro.props.medalSlot.id}`, Astro.url)}
          rel="noopener noreferrer"
          target="_blank"
        >
          {new URL(`/medal/${Astro.props.medalSlot.id}`, Astro.url)}
        </a>
      </figcaption>
    </figure>

    <a
      href={Astro.props.QRbase64}
      class="btn btn-filled btn-lg w-full"
      download={`${Astro.props.medalSlot.id}.png`}
    >
      <Icon name="lucide:download" class="size-4" />
      Descargar QR
    </a>
  </section>
</dialog>

<script define:vars={{ dialog_id }}>
  const dialog = document.getElementById(dialog_id);
  const openBtn = document.getElementById(`${dialog_id}-btn`);

  openBtn.addEventListener('click', () => {
    dialog.showModal();
  });
</script>
