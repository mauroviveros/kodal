---
import { BasicCard, PromoCard } from '@components/cards';
import Layout from '@layout';
import type { MedalResponse } from '@types';

const response = await fetch(
  new URL(`/api/slot/${Astro.params.slot_id}/medal`, Astro.request.url),
  { credentials: 'include' },
);
const { slot, medal }: MedalResponse = await response.json();

if (!slot) return Astro.rewrite('/404');
if (!slot.medal_id) return Astro.redirect(`/medal/${slot.id}/edit`);
if (!medal) return Astro.rewrite('/404');
---

<Layout class="max-w-2xl" container>
  <BasicCard medal={medal} />
  <PromoCard />
</Layout>
